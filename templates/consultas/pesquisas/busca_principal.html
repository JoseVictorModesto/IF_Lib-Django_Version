{% extends 'bases_templates/base/base_consultas.html' %}
{% load static %}
{% block content %}

    <h1 class="titulo_pag_caixa">Pesquisa</h1>

    <div class="infor_filtro div_pesquisa">
        <h1 class="pesquisa"><strong class="resul_pesquisa">Resultados encontrados para:</strong> {{ palavra_chave }}</h1>
    </div>

    <hr class="linha_categoria">

    <div class="opcoes_sub_filtros opcoes_sub_pesquisa">
        <a href="?busca_principal_name={{ palavra_chave }}&ordenados_por=-qtd_favoritos" class="ordem_filtros {% if ordenados_por == '-qtd_favoritos' %}ordem_selecionada{% endif %}">Favoritos</a>
        <a href="?busca_principal_name={{ palavra_chave }}&ordenados_por=-id" class="ordem_filtros {% if ordenados_por == '-id' %}ordem_selecionada{% endif %}">Mais recentes</a>
        <a href="?busca_principal_name={{ palavra_chave }}&ordenados_por=id" class="ordem_filtros {% if ordenados_por == 'id' %}ordem_selecionada{% endif %}">Mais antigos</a>
        <a href="?busca_principal_name={{ palavra_chave }}&ordenados_por=titulo" class="ordem_filtros {% if ordenados_por == 'titulo' %}ordem_selecionada{% endif %}">A/Z</a>
        <a href="?busca_principal_name={{ palavra_chave }}&ordenados_por=-titulo" class="ordem_filtros {% if ordenados_por == '-titulo' %}ordem_selecionada{% endif %}">Z/A</a>
    </div>

    <div class="lista_pesquisa">
    
    {% if conteudo_cai or conteudo_ce %}
        <div class="part_lista_pesquisa">
        {% for i in conteudo_cai %}
            <div class="card">
                {% if i.img_capa_conteudo %}
                    <div>
                        <img src="{{ i.img_capa_conteudo.url }}" class="img_card">
                    </div>
                {% else %}
                    <div>
                        <img src="{% static '/styles/imagens/img_not_found_lib.png' %}" class="img_card">
                    </div>
                {% endif %}
                <div class="base_card">
                    {% if i.validado %}
                        <a href="{% url 'vizualizar_cai' i.id %}" class="titulo_card">{{ i.titulo|slice:":35" }}{% if i.titulo|length > 35 %}...{% endif %}</a>
                    {% endif %} 
                    <div class="infor_card">
                        <h2 class="inst_card">{{ i.instituicao_conteudo }}</h2>
                        <button class="descricao_card">Descrição...</button>
                    </div>
                </div>
                <div class="detalhes_card">
                    <h2 class="tipo_card"><strong class="card_strong">Tipo</strong> {{ i.tipos_conteudo }}</h2>
                    <h3 class="tipo_card"><strong class="card_strong">Postado em</strong> {{ i.data_envio|date:'d/m/Y' }}</h3>
                    <p class="paragrafo_card"><strong class="card_strong">Descrição</strong>{{ i.descricao_conteudo|slice:":260" }}{% if i.descricao_conteudo|length > 260 %}...{% endif %}</p>
                    <button class="retornar_card">Voltar</button>
                </div>
            </div>
        {% endfor %}
        </div>

        <div class="part_lista_pesquisa">
        {% for i in conteudo_ce %}
            <div class="card card_ex">
                {% if i.img_capa %}
                    <div>
                        <img src="{{ i.img_capa.url }}" class="img_card">
                    </div>
                {% else %}
                    <div>
                        <img src="{% static '/styles/imagens/img_not_found_lib_ex.png' %}" class="img_card">
                    </div>
                {% endif %}
                <div class="base_card">
                    <a href="{% url 'vizualizar_ce' i.id %}" class="titulo_card titulo_card_ex">{{ i.titulo|slice:":35" }}{% if i.titulo|length > 35 %}...{% endif %}</a>
                    <div class="infor_card infor_card_ex"> 
                        <h2 class="inst_card">EXT</h2>
                        <button class="descricao_card descricao_card_ex">Descrição...</button>
                    </div>
                </div>
                <div class="detalhes_card detalhes_card_ex">
                    <h2 class="tipo_card"><strong class="card_strong">Tipo</strong> {{ i.tipo_conteudo }}</h2>
                    <h3 class="tipo_card"><strong class="card_strong">Postado em</strong> {{ i.data_envio|date:'d/m/Y' }}</h3>
                    <p class="paragrafo_card"><strong class="card_strong">Descrição</strong> {{ i.descricao_conteudo|slice:":260" }}{% if i.descricao_conteudo|length > 260 %}...{% endif %}</p>
                    <button class="retornar_card retornar_card_ex">Voltar</button>
                </div>
            </div>
        {% endfor %}
        </div>
    {% else %}
        {% if not palavra_chave %}
            <h1 class="pesquisa aviso_busca">Digite uma palavra chave</h1>
        {% else %}
            <h1 class="pesquisa aviso_busca">Nenhum conteúdo encontrado</h1>
        {% endif %}
    {% endif %}
    </div> 

{% endblock %}
